<!-- TOC depthFrom:1 depthTo:3 insertAnchor:false orderedList:false -->

- [PS版DQ7 イノゴン戦シミュレータ](#ps版dq7-イノゴン戦シミュレータ)
  - [使い方](#使い方)
  - [出力の例](#出力の例)
    - [`$option[:N] = 10000`](#optionn--10000)
    - [`$option[:log_timing] = :turn`](#optionlog_timing--turn)
    - [`$option[:log_timing] = :result`](#optionlog_timing--result)
  - [ToDo](#todo)

<!-- /TOC -->

# PS版DQ7 イノゴン戦シミュレータ

PS版DQ7RTAにおいて最も勝率が低いとされている戦闘であるイノゴン戦の勝率を楽して見極めるために**今更**作ったやつ。[RGPツクールVX Ace](https://store.steampowered.com/app/220700/RPG_Maker_VX_Ace/)のスクリプトRGSS3を元にしています。

現在対応しているのは、
- [腹黒パンダ氏の戦術](https://harapan.exblog.jp/15510551/)([装備種配分](https://github.com/pingval/DQ7/raw/master/psdq7-status.zip))
- [自分の戦術](https://github.com/pingval/DQ7/blob/master/pingval-psdq7-Aira183-chart.txt#L1649)([装備種配分](https://github.com/pingval/DQ7/raw/master/psdq7-status.zip))

## 使い方

`Ruby psdq7_InoGon_simulator.rb`

$optionをいろいろ書き換えていろいろやる。

- [シミュレーション結果](results.md)

## 出力の例

### `$option[:N] = 10000`
10000回試行。

```
N: 10000
Log Timing: none

Party: #<Proc:0x00000000061fb930 Party_Pingval.rb:183 (lambda)>
Maribel's Level: 10
Seed Type: rand

* Party
                                    No.1      No.2      No.3
  Status
    Max HP                            59        81        57
    Max MP                             8        29        39
    Atk                               47        64        36
    Def                               45        63        77
    Agi                               44        18        30
    Eva                            3.10%     3.10%    19.25% ; みかわし率
  Item
    Herb                               3         7  Infinity ; 薬草
    Leaf                               0         1         1 ; 世界樹の葉
  Damage Range ; 被ダメージ範囲("*"つきは最大HPでも耐えない)
    Inopp
      Attack                      31..37    27..31    24..28 ; 攻撃
      Fury                        38..46    33..38    30..35 ; 武器を振り回す
      BrutalHit                 *77..*92    67..77  *60..*70 ; 痛恨の一撃
    Gonz
      Attack                      26..30    22..26    18..22
      Tail/Claw                   32..37    27..32    22..27 ; 尻尾/爪できりさく
      BrutalHit                 *65..*75    55..65    45..55

Win rate:	76.69%
* Win
  Ave. turn count: 21.84
  Party:
                                    No.1      No.2      No.3
    Death rate on battle end      16.14%     4.81%     6.42%
    Ave. HP on battle end          42.12     67.77     48.57
    Ave. Herb count                 0.19      1.57       NaN
    Ave. Leaf count                 0.00      0.63      0.56
  Distribution of Leaf count: ; 世界樹の葉消費数の分布
        0    22.02%
        1    36.99%
        2    40.98%
    Ave.       1.19
  Troop:
                                    No.1      No.2
    Death rate on battle end     100.00%   100.00%
    Ave. HP on battle end           0.00      0.00

* Lose
  Ave. turn count: 19.51
  Party:
                                    No.1      No.2      No.3
    Death rate on battle end     100.00%   100.00%   100.00%
    Ave. HP on battle end           0.00      0.00      0.00
    Ave. Herb count                 0.22      1.16       NaN
    Ave. Leaf count                 0.00      0.72      0.68
  Distribution of Leaf count: ; 世界樹の葉消費数の分布
        0     9.65%
        1    41.14%
        2    49.21%
    Ave.       1.40
  Troop:
                                    No.1      No.2
    Death rate on battle end       4.33%     6.65%
    Ave. HP on battle end         143.93    131.57

* Both
  Ave. turn count: 21.30
  Party:
                                    No.1      No.2      No.3
    Death rate on battle end      35.69%    27.00%    28.23%
    Ave. HP on battle end          32.30     51.97     37.25
    Ave. Herb count                 0.20      1.48       NaN
    Ave. Leaf count                 0.00      0.65      0.59
  Distribution of Leaf count: ; 世界樹の葉消費数の分布
        0    19.14%
        1    37.96%
        2    42.90%
    Ave.       1.24
  Troop:
                                    No.1      No.2
    Death rate on battle end      77.70%    78.24%
    Ave. HP on battle end          33.55     30.67
```
### `$option[:log_timing] = :turn`
戦闘ログを1Tごとに出力する。

```
N: 1
Log Timing: turn

Party: #<Proc:0x000000000631f870 Party_Pingval.rb:183 (lambda)>
Maribel's Level: 10
Seed Type: rand

* Party
                                    No.1      No.2      No.3
  Status
    Max HP                            59        80        57
    Max MP                             7        29        38
    Atk                               47        66        36
    Def                               45        63        77
    Agi                               44        18        30
    Eva                            3.10%     3.10%    19.25% ; みかわし率
  Item
    Herb                               3         7  Infinity ; 薬草
    Leaf                               0         1         1 ; 世界樹の葉
  Damage Range ; 被ダメージ範囲("*"つきは最大HPでも耐えない)
    Inopp
      Attack                      31..37    27..31    24..28 ; 攻撃
      Fury                        38..46    33..38    30..35 ; 武器を振り回す
      BrutalHit                 *77..*92    67..77  *60..*70 ; 痛恨の一撃
    Gonz
      Attack                      26..30    22..26    18..22
      Tail/Claw                   32..37    27..32    22..27 ; 尻尾/爪できりさく
      BrutalHit                 *65..*75    55..65    45..55

   1T:      イノ440/440 |      ゴン400/400 |      ガ 59/ 59 |      主 80/ 80 |      マ 57/ 57 |      カシム65000/65000
   2T:      イノ394/440 |      ゴン383/400 |      ガ 59/ 59 |      主 55/ 80 |      マ 57/ 57 |      カシム65000/65000
   3T:      イノ369/440 |      ゴン364/400 |      ガ 43/ 59 |      主 80/ 80 |      マ 57/ 57 |      カシム65000/65000
   4T:      イノ345/440 |      ゴン308/400 |      ガ 43/ 59 |      主 80/ 80 | [死 ]マ  0/ 57 |      カシム65000/65000
   5T:      イノ345/440 |      ゴン278/400 | [死 ]ガ  0/ 59 |      主 57/ 80 |      マ 57/ 57 |      カシム65000/65000
   6T:      イノ312/440 |      ゴン278/400 |      ガ 59/ 59 |      主 42/ 80 |      マ 32/ 57 |      カシム65000/65000
   7T:      イノ312/440 |      ゴン278/400 |      ガ 24/ 59 |      主 75/ 80 |      マ 57/ 57 |      カシム65000/65000
   8T:      イノ290/440 |      ゴン229/400 |      ガ 46/ 59 |      主 75/ 80 |      マ 31/ 57 |      カシム65000/65000
   9T:      イノ269/440 |      ゴン212/400 | [死 ]ガ  0/ 59 |      主 75/ 80 |      マ 57/ 57 |      カシム65000/65000
  10T:      イノ238/440 |      ゴン212/400 | [死 ]ガ  0/ 59 |      主 80/ 80 |      マ 57/ 57 |      カシム64973/65000
  11T:      イノ192/440 |      ゴン192/400 | [死 ]ガ  0/ 59 |      主 80/ 80 |      マ 57/ 57 | [暗5]カシム65000/65000
  12T:      イノ170/440 |      ゴン173/400 | [死 ]ガ  0/ 59 |      主 80/ 80 |      マ 35/ 57 | [暗4]カシム65000/65000
  13T:      イノ145/440 |      ゴン153/400 | [死 ]ガ  0/ 59 |      主 80/ 80 | [暗6]マ 35/ 57 | [暗3]カシム65000/65000
  14T:      イノ124/440 |      ゴン134/400 | [死 ]ガ  0/ 59 |      主 80/ 80 | [暗5]マ 35/ 57 | [暗2]カシム65000/65000
  15T:      イノ102/440 |      ゴン114/400 | [死 ]ガ  0/ 59 |      主 80/ 80 | [暗4]マ 35/ 57 | [暗1]カシム65000/65000
  16T:      イノ102/440 |      ゴン114/400 | [死 ]ガ  0/ 59 | [暗6]主 80/ 80 | [暗3]マ 35/ 57 |      カシム65000/65000
  17T:      イノ 74/440 |      ゴン114/400 | [死 ]ガ  0/ 59 | [暗5]主 80/ 80 | [暗2]マ 15/ 57 |      カシム65000/65000
  18T:      イノ 42/440 |      ゴン114/400 | [死 ]ガ  0/ 59 | [暗4]主 80/ 80 | [暗1]マ 51/ 57 |      カシム65000/65000
  19T:      イノ 42/440 |      ゴン114/400 | [死 ]ガ  0/ 59 | [暗3]主 80/ 80 |      マ 23/ 57 |      カシム65000/65000
  20T:      イノ 13/440 |      ゴン114/400 | [死 ]ガ  0/ 59 | [暗2]主 66/ 80 |      マ 55/ 57 |      カシム65000/65000
  21T:      イノ 13/440 |      ゴン114/400 | [死 ]ガ  0/ 59 | [暗1]主 80/ 80 |      マ 35/ 57 | [暗4]カシム65000/65000
  22T:      イノ 13/440 |      ゴン114/400 | [死 ]ガ  0/ 59 |      主 80/ 80 |      マ 13/ 57 | [暗3]カシム65000/65000
  23T: [死 ]イノ  0/440 |      ゴン 94/400 | [死 ]ガ  0/ 59 |      主 80/ 80 | [死 ]マ  0/ 57 | [暗2]カシム65000/65000
  24T: [死 ]イノ  0/440 |      ゴン 94/400 | [死 ]ガ  0/ 59 |      主 80/ 80 | [死 ]マ  0/ 57 | [暗1]カシム65000/65000
  25T: [死 ]イノ  0/440 |      ゴン 94/400 | [死 ]ガ  0/ 59 |      主 80/ 80 | [死 ]マ  0/ 57 |      カシム65000/65000
  26T: [死 ]イノ  0/440 |      ゴン 66/400 | [死 ]ガ  0/ 59 |      主 67/ 80 | [死 ]マ  0/ 57 |      カシム65000/65000
  27T: [死 ]イノ  0/440 |      ゴン 66/400 | [死 ]ガ  0/ 59 |      主 52/ 80 | [死 ]マ  0/ 57 |      カシム65000/65000
  28T: [死 ]イノ  0/440 |      ゴン 30/400 | [死 ]ガ  0/ 59 |      主 52/ 80 | [死 ]マ  0/ 57 |      カシム65000/65000
  29T: [死 ]イノ  0/440 |      ゴン  4/400 | [死 ]ガ  0/ 59 |      主 40/ 80 | [死 ]マ  0/ 57 |      カシム65000/65000
 Win!: [死 ]イノ  0/440 | [死 ]ゴン  0/400 | [死 ]ガ  0/ 59 |      主  9/ 80 | [死 ]マ  0/ 57 |      カシム65000/65000

                                    No.1      No.2      No.3
  Item
    Herb                         (3-0=)3   (7-1=)6  Infinity ; 薬草
    Leaf                         (0-0=)0   (1-1=)0   (1-1=)0 ; 世界樹の葉
```

### `$option[:log_timing] = :result`
戦闘ログを最も詳しく出力する。

```
N: 1
Log Timing: result

Party: #<Proc:0x0000000006258040 Party_Pingval.rb:183 (lambda)>
Maribel's Level: 10
Seed Type: rand

* Party
                                    No.1      No.2      No.3
  Status
    Max HP                            59        82        57
    Max MP                             8        29        39
    Atk                               47        64        36
    Def                               45        64        77
    Agi                               45        18        30
    Eva                            3.10%     3.10%    19.25% ; みかわし率
  Item
    Herb                               3         7  Infinity ; 薬草
    Leaf                               0         1         1 ; 世界樹の葉
  Damage Range ; 被ダメージ範囲("*"つきは最大HPでも耐えない)
    Inopp
      Attack                      31..37    27..31    24..28 ; 攻撃
      Fury                        38..46    33..38    30..35 ; 武器を振り回す
      BrutalHit                 *77..*92    67..77  *60..*70 ; 痛恨の一撃
    Gonz
      Attack                      26..30    21..25    18..22
      Tail/Claw                   32..37    26..31    22..27 ; 尻尾/爪できりさく
      BrutalHit                 *65..*75    52..62    45..55

   1T:      イノ440/440 |      ゴン400/400 |      ガ 59/ 59 |      主 82/ 82 |      マ 57/ 57 |      カシム65000/65000
    ガ: 防御
    ゴン: 痛恨の一撃(攻撃×2.5) to カシム
      カシム: HP-67 (64933/65000)
    イノ: 攻撃 to ガ
      ガ: HP-18 ( 41/ 59)
    カシム: 攻撃 to ゴン
      ゴン: HP-26 (374/400)
    マ: 奇跡の石 to ガ
      ガ: HP+38 ( 59/ 59)
    主: ブーメラン to イノ, ゴン
      イノ: HP-20 (420/440)
      ゴン: HP-18 (356/400)
   2T:      イノ420/440 |      ゴン356/400 |      ガ 59/ 59 |      主 82/ 82 |      マ 57/ 57 |      カシム65000/65000
    ガ: 防御
    ゴン: 痛恨の一撃(攻撃×2.5) to ガ
      ガ: HP-37 ( 22/ 59)
    イノ: 痛恨の一撃(攻撃×2.5) to 主
      主: HP-67 ( 15/ 82)
    カシム: 様子を見る
    マ: 奇跡の石 to ガ
      ガ: HP+30 ( 52/ 59)
    主: ブーメラン to イノ, ゴン
      イノ: HP-24 (396/440)
      ゴン: HP-19 (337/400)
   3T:      イノ396/440 |      ゴン337/400 |      ガ 52/ 59 |      主 15/ 82 |      マ 57/ 57 |      カシム65000/65000
    ガ: 防御
    主: 防御
    ゴン: 攻撃 to マ
      マ: HP-22 ( 35/ 57)
    イノ: 攻撃 to カシム
      カシム: HP-36 (64964/65000)
    カシム: 斬りつける to イノ
      イノ: HP-33 (363/440)
    マ: 奇跡の石 to 主
      主: HP+38 ( 53/ 82)
   4T:      イノ363/440 |      ゴン337/400 |      ガ 52/ 59 |      主 53/ 82 |      マ 35/ 57 |      カシム65000/65000
    ガ: 防御
    ゴン: 爪できりさく to 主
      主: HP-31 ( 22/ 82)
    イノ: 武器を振り回す to 主
      主: HP-37 (  0/ 82)
    カシム: 攻撃 to イノ
      イノ: HP-25 (338/440)
    マ: 奇跡の石 to マ
      マ: HP+39 ( 57/ 57)
   5T:      イノ338/440 |      ゴン337/400 |      ガ 52/ 59 | [死 ]主  0/ 82 |      マ 57/ 57 |      カシム65000/65000
    ガ: 防御
    イノ: 武器を振り回す to ガ
      ガ: HP-21 ( 31/ 59)
    ゴン: 痛恨の一撃(攻撃×2.5) to ガ
      ガ: HP-35 (  0/ 59)
    カシム: 斬りつける to ゴン
      ゴン: HP-37 (300/400)
    マ: 世界樹の葉 to 主
      主: HP+82 ( 82/ 82)
   6T:      イノ338/440 |      ゴン300/400 | [死 ]ガ  0/ 59 |      主 82/ 82 |      マ 57/ 57 |      カシム65000/65000
    イノ: 武器を振り回す to カシム
      カシム: HP-40 (64960/65000)
    カシム: 様子を見る
    ゴン: 攻撃 to 主
      主: HP-24 ( 58/ 82)
    マ: 奇跡の石 to 主
      主: HP+40 ( 82/ 82)
    主: 世界樹の葉 to ガ
      ガ: HP+59 ( 59/ 59)
   7T:      イノ338/440 |      ゴン300/400 |      ガ 59/ 59 |      主 82/ 82 |      マ 57/ 57 |      カシム65000/65000
    ガ: 防御
    カシム: 攻撃 to ゴン
      ゴン: HP-26 (274/400)
    ゴン: 痛恨の一撃(攻撃×2.5) to カシム
      カシム: HP-70 (64930/65000)
    イノ: 砂煙 to ガ, 主, マ, カシム
      マ: evaded
    主: ブーメラン to イノ, ゴン
      イノ: HP-23 (315/440)
      ゴン: HP-18 (256/400)
    マ: 奇跡の石 to 主
   8T:      イノ315/440 |      ゴン256/400 |      ガ 59/ 59 |      主 82/ 82 |      マ 57/ 57 |      カシム65000/65000
    ガ: 防御
    カシム: 様子を見る
    イノ: 攻撃 to 主
      主: HP-28 ( 54/ 82)
    ゴン: 痛恨の一撃(攻撃×2.5) to マ
      マ: HP-52 (  5/ 57)
    マ: 奇跡の石 to 主
      主: HP+36 ( 82/ 82)
    主: ブーメラン to イノ, ゴン
      イノ: HP-23 (292/440)
      ゴン: HP-19 (237/400)
   9T:      イノ292/440 |      ゴン237/400 |      ガ 59/ 59 |      主 82/ 82 |      マ  5/ 57 |      カシム65000/65000
    ガ: 防御
    イノ: 砂煙 to ガ, 主, マ, カシム
      ガ: +[暗5]
      主: +[暗6]
      マ: evaded
      カシム: +[暗6]
    カシム: 斬りつける to ゴン
      missed to ゴン
    ゴン: 攻撃 to マ
      マ: HP-22 (  0/ 57)
    主: 薬草 to ガ
  10T:      イノ292/440 |      ゴン237/400 | [暗5]ガ 59/ 59 | [暗5]主 82/ 82 | [死 ]マ  0/ 57 | [暗5]カシム65000/65000
    ガ: 防御
    ゴン: 爪できりさく to 主
      主: HP-27 ( 55/ 82)
    イノ: 攻撃 to 主
      主: HP-27 ( 28/ 82)
    カシム: 攻撃 to イノ
      missed to イノ
    主: ブーメラン to イノ, ゴン
      missed to イノ
      missed to ゴン
  11T:      イノ292/440 |      ゴン237/400 | [暗4]ガ 59/ 59 | [暗4]主 28/ 82 | [死 ]マ  0/ 57 | [暗4]カシム65000/65000
    ガ: 防御
    主: 防御
    カシム: 斬りつける to イノ
      イノ: HP-33 (259/440)
    イノ: 攻撃 to 主
      主: HP-15 ( 13/ 82)
    ゴン: 攻撃 to ガ
      ガ: HP-14 ( 45/ 59)
  12T:      イノ259/440 |      ゴン237/400 | [暗3]ガ 45/ 59 | [暗3]主 13/ 82 | [死 ]マ  0/ 57 | [暗3]カシム65000/65000
    ガ: 防御
    ゴン: 爪できりさく to ガ
      ガ: HP-16 ( 29/ 59)
    カシム: 様子を見る
    イノ: 攻撃 to カシム
      カシム: HP-34 (64966/65000)
    主: 薬草 to 主
      主: HP+31 ( 44/ 82)
  13T:      イノ259/440 |      ゴン237/400 | [暗2]ガ 29/ 59 | [暗2]主 44/ 82 | [死 ]マ  0/ 57 | [暗2]カシム65000/65000
    ガ: 防御
    主: 防御
    ゴン: 爪できりさく to ガ
      ガ: HP-17 ( 12/ 59)
    イノ: 攻撃 to 主
      主: HP-14 ( 30/ 82)
    カシム: 攻撃 to ゴン
      ゴン: HP-28 (209/400)
  14T:      イノ259/440 |      ゴン209/400 | [暗1]ガ 12/ 59 | [暗1]主 30/ 82 | [死 ]マ  0/ 57 | [暗1]カシム65000/65000
    主: 防御
    ゴン: 攻撃 to ガ
      ガ: HP-30 (  0/ 59)
    イノ: 砂煙 to 主, カシム
    カシム: 様子を見る
  15T:      イノ259/440 |      ゴン209/400 | [死 ]ガ  0/ 59 |      主 30/ 82 | [死 ]マ  0/ 57 |      カシム65000/65000
    主: 防御
    イノ: 攻撃 to 主
      主: HP-14 ( 16/ 82)
    ゴン: 攻撃 to 主
      主: HP-12 (  4/ 82)
    カシム: 斬りつける to ゴン
      ゴン: HP-36 (173/400)
  16T:      イノ259/440 |      ゴン173/400 | [死 ]ガ  0/ 59 |      主  4/ 82 | [死 ]マ  0/ 57 |      カシム65000/65000
    イノ: 痛恨の一撃(攻撃×2.5) to 主
      主: HP-70 (  0/ 82)
Lose!:      イノ259/440 |      ゴン173/400 | [死 ]ガ  0/ 59 | [死 ]主  0/ 82 | [死 ]マ  0/ 57 |      カシム65000/65000

                                    No.1      No.2      No.3
  Item
    Herb                         (3-0=)3   (7-1=)6  Infinity ; 薬草
    Leaf                         (0-0=)0   (1-1=)0   (1-1=)0 ; 世界樹の葉
```

## ToDo
- [ ] 戦術をちゃんとする
  - [ ] 先読み葉っぱ
  - [ ] イノゴン片方が落ちた場合
  - [x] 行動のチェック
- [ ] 汚いコードをちゃんとする
- [ ] けった1249
- [ ] おかかメシさんの打打石
- [ ] 奴隷先輩1250
- [x] victoryとwinをちゃんとする
- [x] 行動順値の決定タイミングはコマンド入力前
- [x] カシムHP自動回復
- [x] ステータス出力
- [x] 戦闘終了時のアイテム出力
